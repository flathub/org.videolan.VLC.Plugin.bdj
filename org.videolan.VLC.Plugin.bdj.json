{
  "id": "org.videolan.VLC.Plugin.bdj",
  "build-extension": true,
  "runtime": "org.videolan.VLC",
  "runtime-version": "stable",
  "branch": "3-20.08",
  "sdk": "org.freedesktop.Sdk//20.08",
  "sdk-extensions": ["org.freedesktop.Sdk.Extension.openjdk8"],
  "separate-locales": false,
  "appstream-compose": false,
  "build-options": {
    "env": {
      "V": "1",
      "JAVA_HOME": "/usr/lib/sdk/openjdk8"
    },
    "append-path": "/usr/lib/sdk/openjdk8/bin"
  },
  "cleanup-commands": [
    "ln -s /app/share/vlc/extra/bdj/share/java/libbluray-j2se-1.2.1.jar /app/share/vlc/extra/bdj/share/java/libbluray.jar"
  ],
  "modules": [
    {
      "name": "openjdk",
        "buildsystem": "simple",
        "build-commands": [
          "mkdir -p /app/share/vlc/extra/bdj/jre",
          "cp -r /usr/lib/sdk/openjdk8/jvm/java-8-openjdk/* /app/share/vlc/extra/bdj/jre",
          "rm -rf /app/share/vlc/extra/bdj/jre/src.zip /app/share/vlc/extra/bdj/jre/include /app/share/vlc/extra/bdj/jre/demo /app/share/vlc/extra/bdj/jre/sample"
        ]
    },
    {
      "name": "ant",
      "buildsystem": "simple",
      "build-commands": [
        "mkdir -p /app/share/vlc/extra/bdj/ant",
        "tar xf apache-ant-bin.tar.bz2 --strip-components=1 --directory=/app/share/vlc/extra/bdj/ant"
      ],
      "sources": [
        {
          "type": "file",
          "url": "https://archive.apache.org/dist/ant/binaries/apache-ant-1.10.12-bin.tar.bz2",
          "dest-filename": "apache-ant-bin.tar.bz2",
          "sha512": "3587dfdcbc35c49ee21949cab0306adb2a7e679d6cf90e3030cf5d264db2411a3957d896c467a39806ac53bc6080b94182f233aa3e5d7ba327d82a6ab24748a4"
        }
      ]
    },
    {
      "name": "libbluray",
      "config-opts": ["--enable-shared", "--disable-static", "--prefix=/app/share/vlc/extra/bdj"],
      "build-options": {
        "append-path": "/app/share/vlc/extra/bdj/ant/bin"
      },
      "sources": [
        {
          "type": "archive",
          "url": "http://ftp.videolan.org/videolan/libbluray/1.3.0/libbluray-1.3.0.tar.bz2",
          "sha256": "e2dbaf99e84e0a9725f4985bcb85d41e52c2261cc651d8884b1b790b5ef016f9"
        }
      ]
    },
    {
      "name": "envvars",
      "buildsystem": "simple",
      "build-commands": [
        "mv bdj-env.sh /app/share/vlc/extra/bdj",
        "rm -rf /app/share/vlc/extra/bdj/ant",
        "install -Dm644 --target-directory=${FLATPAK_DEST}/share/metainfo org.videolan.VLC.Plugin.bdj.appdata.xml",
        "appstream-compose --basename=org.videolan.VLC.Plugin.bdj --prefix=${FLATPAK_DEST} --origin=flatpak org.videolan.VLC.Plugin.bdj"
      ],
      "sources": [
        {
          "type": "file",
          "path": "bdj-env.sh"
        },
        {
          "type": "file",
          "path": "org.videolan.VLC.Plugin.bdj.appdata.xml"
        }
      ]
    }
  ]
}
